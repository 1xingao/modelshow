# 三维地质模型可视化系统

基于 Vue2 + Three.js 开发的三维地质模型可视化系统，支持 GLTF 格式的地质模型加载、多层地质结构管理和交互式3D可视化。

## 功能特点

### 🎯 核心功能
- **GLTF模型加载**：支持加载GLTF格式的三维地质模型
- **多层地质管理**：自动解析模型中的多个地层，支持独立控制
- **交互式3D视图**：基于Three.js的高性能3D渲染和交互
- **多视角展示**：提供前、后、左、右、顶、底六个标准视角

### 🎨 可视化功能
- **边缘线显示**：切换模型的线框显示模式
- **透明度控制**：每个地层独立的透明度调节（0-100%）
- **显示/隐藏**：每个地层可独立显示或隐藏
- **相机控制**：支持鼠标拖拽旋转、缩放、平移
- **自动定位**：模型加载后自动调整相机到最佳观察位置

### 📊 信息展示
- **模型统计**：显示顶点数、面数等模型信息
- **地层列表**：显示所有地层的名称和控制选项
- **加载状态**：实时显示模型加载进度

## 系统架构

### 组件结构
```
App.vue                 # 主应用组件
├── AppHeader.vue       # 顶部导航栏
├── ModelControlPanel.vue  # 左侧控制面板
└── ModelViewer.vue     # 3D模型查看器
```

### 核心技术
- **前端框架**：Vue 2.6.14
- **3D引擎**：Three.js 0.180.0
- **模型格式**：GLTF/GLB
- **构建工具**：Vue CLI 5.0

## 使用说明

### 安装依赖
```bash
npm install
```

### 开发环境运行
```bash
npm run serve
```

### 生产环境构建
```bash
npm run build
```

## 操作指南

### 1. 模型加载
1. 点击左侧面板的 **"加载模型"** 按钮
2. 系统会自动加载 `public/model_gltf/output_model.gltf` 文件
3. 加载完成后，相机会自动调整到最佳观察位置

### 2. 基本操作
- **旋转**：按住鼠标左键拖拽
- **缩放**：使用鼠标滚轮
- **平移**：按住鼠标右键拖拽
- **重新定位**：点击 **"重新定位"** 按钮恢复最佳视角

### 3. 显示控制
- **边缘线**：勾选 "显示边缘线" 切换线框模式
- **视角切换**：使用六个视角按钮快速切换观察角度
- **模型清除**：点击 **"清除模型"** 移除当前模型

### 4. 地层管理
- **显示/隐藏**：勾选/取消勾选地层名称前的复选框
- **透明度**：使用滑动条调节每个地层的透明度
- **地层信息**：查看每个地层的名称和属性

## 模型文件要求

### GLTF模型规范
- **格式**：GLTF 2.0 或 GLB 格式
- **结构**：支持多个Mesh对象表示不同地层
- **材质**：支持PBR材质和基础材质
- **纹理**：支持各种纹理格式

### 文件组织
```
public/
├── model_gltf/
│   ├── output_model.gltf    # 主模型文件
│   ├── gltf_buffer_0.bin    # 几何数据文件
│   ├── gltf_buffer_1.bin
│   └── ...                  # 其他资源文件
├── model_3dtiles/           # 3DTiles格式模型（预留）
└── model/                   # 其他格式模型（预留）
```

## API文档

### ModelViewer 组件

#### Props
无

#### Events
- `loading-start`: 开始加载模型
- `loading-end`: 模型加载完成
- `loading-progress(percent)`: 加载进度更新
- `loading-error(message)`: 加载失败
- `model-loaded(data)`: 模型加载成功
- `model-cleared`: 模型清除完成

#### Methods
- `loadModel(path)`: 加载指定路径的模型
- `clearModel()`: 清除当前模型
- `resetCamera()`: 重置相机位置
- `toggleWireframe(show)`: 切换边缘线显示
- `setView(viewType)`: 设置视角
- `toggleLayerVisibility(layerId, visible)`: 切换地层可见性
- `updateLayerOpacity(layerId, opacity)`: 更新地层透明度

### ModelControlPanel 组件

#### Props
- `modelLoaded`: Boolean - 模型是否已加载
- `loading`: Boolean - 是否正在加载
- `layers`: Array - 地层数据数组
- `modelInfo`: Object - 模型信息

#### Events
- `load-model`: 请求加载模型
- `clear-model`: 请求清除模型
- `reset-camera`: 请求重置相机
- `toggle-wireframe(show)`: 切换边缘线
- `set-view(viewType)`: 设置视角
- `toggle-layer-visibility(data)`: 切换地层可见性
- `update-layer-opacity(data)`: 更新地层透明度

## 扩展功能

### 计划中的功能
1. **数据上传**：支持用户上传自定义模型文件
2. **数据处理**：模型格式转换和优化工具
3. **系统设置**：个性化配置和主题设置
4. **导出功能**：模型截图和数据导出
5. **测量工具**：距离、面积、体积测量
6. **剖面分析**：地质剖面切割和分析

### 性能优化
- **LOD渲染**：根据距离自动调整模型细节
- **frustum culling**：视锥体裁剪优化
- **批量渲染**：合并相似几何体减少drawcall
- **纹理压缩**：自动压缩纹理减少内存占用

## 故障排除

### 常见问题

**Q: 模型加载失败怎么办？**
A: 检查以下几点：
1. 确保模型文件路径正确
2. 检查GLTF文件格式是否有效
3. 查看浏览器开发者工具中的网络请求
4. 确认所有.bin文件都在正确位置

**Q: 性能不佳如何优化？**
A: 尝试以下方法：
1. 简化模型复杂度
2. 优化纹理分辨率
3. 使用更现代的浏览器
4. 关闭不必要的视觉效果

**Q: 地层显示异常？**
A: 检查模型结构：
1. 确保每个地层是独立的Mesh对象
2. 检查材质是否正确设置
3. 验证几何体法线方向

## 开发团队

基于目标需求文档开发，集成了现代Web3D技术栈，为地质模型可视化提供专业解决方案。

## 许可证

本项目仅用于学习和研究目的。